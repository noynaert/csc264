# 11.020 Recap

## System V AMD64 ABI Calling Convention

The [System V AMD64 ABI](https://refspecs.linuxbase.org/elf/x86_64-abi-0.99.pdf) (Application Binary Interface) is the standard calling convention used on Unix-like operating systems (such as Linux and macOS) for x86-64 architecture. It defines how functions receive parameters from the caller, how return values are passed back, and how the stack is managed during function calls.

## Parameters are passed in registers (and the stack)

In the x86-64 calling convention, the first six integer or pointer parameters to a function are passed in specific registers:
- 1st parameter: RDI
- 2nd parameter: RSI
- 3rd parameter: RDX
- 4th parameter: RCX
- 5th parameter: R8
- 6th parameter: R9

If there are more than six parameters, the additional parameters are passed on the stack.

# Return values are passed in registers
Function return values are typically passed back to the caller using specific registers:
- For integer or pointer return values, the RAX register is used.

## We need to protect the caller's environment

Functions can change the values in registers.  

### Caller-Saved Registers 

Registers like %rax, %rcx, %rdx, %rsi, %rdi, %r8, %r9, %r10, and %r11 are considered caller-saved. This means the calling function is responsible for saving their values before a function call if it needs them after the call.

### Callee-Saved Registers

Registers such as %rbp, %rbx, %r12, %r13, %r14, and %r15 are callee-saved. The called function is responsible for preserving their values (e.g., by pushing them onto the stack at the beginning and popping them off before returning) if it modifies them.